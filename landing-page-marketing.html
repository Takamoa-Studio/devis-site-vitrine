<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculateur landing page marketing</title>
  <link rel="icon" type="image/webp" href="assets/favicon.webp">
  <style>
    :root {
      --bg: #0f172a;
      --bg-alt: #020617;
      --card: #020617;
      --card-soft: #0b1220;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.1);
      --accent-2: #4ade80;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.8);
      --shadow-chip: 0 10px 24px rgba(15, 23, 42, 0.7);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1d283a 0, #020617 45%, #000 100%);
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
    }

    .page {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 48px;
    }

    header {
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .brand-logo-img {
      width: 180px;
      filter: drop-shadow(0 10px 30px rgba(56, 189, 248, 0.35));
    }

    .brand-subtitle {
      font-size: 0.82rem;
      letter-spacing: 0.18em;
      color: var(--muted);
    }

    .pill {
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(56, 189, 248, 0.4);
      color: var(--accent);
      font-size: 0.78rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: var(--shadow-chip);
      white-space: nowrap;
    }

    main {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1fr);
      gap: 20px;
      align-items: flex-start;
    }

    @media (max-width: 900px) {
      main { grid-template-columns: 1fr; }
    }

    h1, h2, h3 { margin: 0; font-weight: 600; letter-spacing: 0.03em; }
    h1 { font-size: clamp(1.7rem, 3vw, 2.2rem); }
    h2 { font-size: 1rem; text-transform: uppercase; color: var(--muted); }

    .card {
      background: radial-gradient(circle at top left, rgba(56,189,248,0.08) 0, rgba(15,23,42,0.95) 45%, #020617 100%);
      border-radius: var(--radius-lg);
      padding: 18px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: var(--shadow-soft);
    }

    .card + .card { margin-top: 14px; }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 12px;
    }

    .card-header p { margin: 0; color: var(--muted); }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(56, 189, 248, 0.08);
      color: var(--accent);
      border: 1px solid rgba(56, 189, 248, 0.35);
    }

    .tag-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #4ade80;
      box-shadow: 0 0 12px rgba(74, 222, 128, 0.9);
    }

    .grid { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }

    .field { display: flex; flex-direction: column; gap: 6px; font-size: 0.9rem; }
    .field label { color: var(--muted); font-size: 0.82rem; display: flex; justify-content: space-between; }
    .field input, .field select { padding: 10px 12px; border-radius: var(--radius-md); border: 1px solid rgba(148, 163, 184, 0.35); background: rgba(15, 23, 42, 0.6); color: var(--text); }

    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px 8px; text-align: left; }
    th { text-transform: uppercase; font-size: 0.78rem; letter-spacing: 0.05em; color: var(--muted); border-bottom: 1px solid rgba(148, 163, 184, 0.25); }
    tr + tr td { border-top: 1px solid rgba(31,41,55,0.8); }
    td small { color: var(--muted); }

    .summary {
      position: sticky;
      top: 16px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .summary-value { font-size: 1.6rem; font-weight: 700; }
    .summary-sub { margin: 0; color: var(--muted); font-size: 0.88rem; }

    .pill-mini {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.9);
      color: var(--accent);
      font-size: 0.75rem;
    }

    .tasks-note { margin-top: 8px; color: var(--muted); font-size: 0.85rem; }
    .hours-input { width: 90px; }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="brand">
        <img src="assets/logo.webp" alt="Logo Takamoa" class="brand-logo-img">
        <span class="brand-subtitle">Landing page marketing</span>
      </div>
      <div class="pill"><span class="tag-dot"></span>Calculateur temps réel</div>
    </header>

    <main>
      <div>
        <section class="card">
          <div class="card-header">
            <div>
              <h2>Paramètres du projet</h2>
              <p>Régle les presets et les coefficients globaux.</p>
            </div>
            <div class="tag"><span class="tag-dot"></span>Marketing & CRO</div>
          </div>

          <div class="grid">
            <div class="field">
              <label for="param_type_site">Type de landing</label>
              <select id="param_type_site">
                <option value="express">Landing express</option>
                <option value="campagne" selected>Landing campagne</option>
                <option value="premium">Landing premium</option>
              </select>
            </div>
            <div class="field">
              <label for="param_comment">Intitulé du projet</label>
              <input id="param_comment" type="text" placeholder="Campagne ads Q4 - SaaS B2B">
            </div>
            <div class="field">
              <label for="param_complexity">Complexité</label>
              <select id="param_complexity">
                <option value="0.9">Simple (x0.9)</option>
                <option value="1" selected>Standard (x1.0)</option>
                <option value="1.2">Renforcé (x1.2)</option>
              </select>
            </div>
            <div class="field">
              <label for="param_buffer">Buffer imprévus (%)</label>
              <input id="param_buffer" type="number" min="0" step="1" value="10">
            </div>
            <div class="field">
              <label for="param_margin">Marge commerciale (x)</label>
              <input id="param_margin" type="number" min="1" step="0.05" value="1.30">
            </div>
            <div class="field">
              <label for="param_tariff_preset">Preset tarifs équipe</label>
              <select id="param_tariff_preset">
                <option value="freelance">Freelances spécialisés</option>
                <option value="agence" selected>Agence experte</option>
                <option value="premium">Agence premium</option>
              </select>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="card-header">
            <div>
              <h2>Équipe & TJM</h2>
              <p>Personnalise les tarifs par rôle.</p>
            </div>
            <span class="pill-mini" id="team_currency">€/h</span>
          </div>
          <div class="grid" id="roles_grid"></div>
        </section>

        <section class="card">
          <div class="card-header">
            <div>
              <h2>Backlog des tâches</h2>
              <p>Aligné sur un cycle complet de landing marketing.</p>
            </div>
            <span class="pill-mini" id="preset_hint">Preset campagne</span>
          </div>
          <div class="tasks-table-wrapper">
            <table id="tasks_table" aria-label="Tâches marketing"></table>
            <p class="tasks-note">Ajuste les heures par tâche si besoin. Le multiplicateur de complexité s'applique automatiquement.</p>
          </div>
        </section>
      </div>

      <aside class="summary card">
        <div class="card-header">
          <div>
            <h2>Résumé</h2>
            <p>Volumes basés sur les rôles et la complexité.</p>
          </div>
          <span class="pill-mini" id="summary_preset"></span>
        </div>

        <div>
          <p class="summary-sub">Total heures</p>
          <div class="summary-value" id="summary_hours">0 h</div>
        </div>
        <div>
          <p class="summary-sub">Coût interne (buffer inclus)</p>
          <div class="summary-value" id="summary_internal">0 €</div>
          <p class="summary-sub" id="summary_buffer_detail"></p>
        </div>
        <div>
          <p class="summary-sub">Prix conseillé (marge appliquée)</p>
          <div class="summary-value" id="summary_sell">0 €</div>
          <p class="summary-sub" id="summary_margin_detail"></p>
        </div>
        <div>
          <p class="summary-sub">Tarif jour moyen</p>
          <div class="summary-value" id="summary_tjm">0 €</div>
        </div>
      </aside>
    </main>
  </div>

  <script>
    const roles = [
      { id: "cp", name: "Chef de projet / Relation client", rate: 35 },
      { id: "strat", name: "Chef de projet / Stratège marketing", rate: 40 },
      { id: "copy", name: "Copywriter / Marketer", rate: 38 },
      { id: "design", name: "Webdesigner / UX-UI", rate: 36 },
      { id: "motion", name: "Webdesigner / Motion / Graphiste", rate: 34 },
      { id: "dev", name: "Développeur Front / WordPress", rate: 42 },
      { id: "int", name: "Développeur / Intégrateur", rate: 40 },
      { id: "traffic", name: "Trafic manager / Web analyst", rate: 38 },
      { id: "seo", name: "SEO / Développeur", rate: 36 },
      { id: "qa", name: "QA / Tests", rate: 32 },
      { id: "marketer", name: "Marketer / Copywriter / Designer", rate: 37 }
    ];

    const RATE_PRESETS = {
      freelance: { label: "Freelances spécialisés", rates: { cp: 32, strat: 35, copy: 35, design: 32, motion: 30, dev: 36, int: 34, traffic: 32, seo: 32, qa: 28, marketer: 33 } },
      agence: { label: "Agence experte", rates: { cp: 45, strat: 48, copy: 46, design: 44, motion: 42, dev: 50, int: 46, traffic: 44, seo: 44, qa: 38, marketer: 45 } },
      premium: { label: "Agence premium", rates: { cp: 65, strat: 70, copy: 68, design: 66, motion: 62, dev: 72, int: 70, traffic: 68, seo: 66, qa: 55, marketer: 68 } }
    };

    const SITE_PRESETS = {
      express: { label: "Preset express", complexity: 0.9, buffer: 8, margin: 1.2, hoursMultiplier: 0.85 },
      campagne: { label: "Preset campagne", complexity: 1, buffer: 10, margin: 1.3, hoursMultiplier: 1 },
      premium: { label: "Preset premium", complexity: 1.15, buffer: 15, margin: 1.4, hoursMultiplier: 1.15 }
    };

    const tasks = [
      { phase: "Cadrage", label: "Atelier de découverte : objectif, offre, cible, promesse", role: "cp", baseHours: 2.5 },
      { phase: "Cadrage", label: "Définition de la structure de la landing (sections & CTA)", role: "strat", baseHours: 2.5 },
      { phase: "Copywriting", label: "Rédaction du message clé (hero, promesse, sous-titre, CTA)", role: "copy", baseHours: 3 },
      { phase: "Copywriting", label: "Rédaction des sections : bénéfices, preuve sociale, FAQ, objections", role: "copy", baseHours: 4.5 },
      { phase: "Design", label: "Maquette UX/UI de la landing page", role: "design", baseHours: 6 },
      { phase: "Design", label: "Création / sélection des visuels (images, icônes, illustrations)", role: "motion", baseHours: 4 },
      { phase: "Intégration", label: "Intégration de la landing (WordPress / Webflow / HTML)", role: "dev", baseHours: 6 },
      { phase: "Intégration", label: "Mise en place du formulaire / système de prise de rendez-vous", role: "int", baseHours: 2.5 },
      { phase: "Tracking & Data", label: "Installation analytics (GA4, pixels pub)", role: "traffic", baseHours: 2 },
      { phase: "Tracking & Data", label: "Configuration des conversions (clic CTA, envoi formulaire, etc.)", role: "traffic", baseHours: 2 },
      { phase: "SEO", label: "Optimisation on-page (title, meta, Hn, performances, mobile)", role: "seo", baseHours: 3 },
      { phase: "Recette", label: "Tests fonctionnels (formulaire, emails, redirections)", role: "qa", baseHours: 2 },
      { phase: "Recette", label: "Tests responsive & bugfix", role: "qa", baseHours: 2 },
      { phase: "Optimisation", label: "Analyse des premières données (taux de conversion, CPC, etc.)", role: "traffic", baseHours: 2 },
      { phase: "Optimisation", label: "Itérations : A/B tests sur titres, visuels, CTA", role: "marketer", baseHours: 3 }
    ];

    const rolesById = Object.fromEntries(roles.map(r => [r.id, r]));

    function renderRoles() {
      const grid = document.getElementById("roles_grid");
      grid.innerHTML = "";
      roles.forEach(role => {
        const wrapper = document.createElement("div");
        wrapper.className = "field";
        const label = document.createElement("label");
        label.textContent = role.name;
        const input = document.createElement("input");
        input.type = "number";
        input.min = 0;
        input.step = 1;
        input.value = role.rate;
        input.addEventListener("input", () => {
          role.rate = Number(input.value) || 0;
          recalc();
        });
        wrapper.append(label, input);
        grid.appendChild(wrapper);
      });
    }

    function renderTasks() {
      const table = document.getElementById("tasks_table");
      const header = `
        <thead><tr><th>Phase</th><th>Tâche</th><th>Rôle</th><th>Heures</th></tr></thead>
      `;
      const rows = tasks.map((task, index) => {
        const roleName = rolesById[task.role]?.name || "";
        return `
          <tr>
            <td>${task.phase}</td>
            <td>${task.label}</td>
            <td><small>${roleName}</small></td>
            <td><input class="hours-input" type="number" min="0" step="0.25" value="${task.baseHours}" data-task-index="${index}"></td>
          </tr>
        `;
      }).join("");
      table.innerHTML = header + `<tbody>${rows}</tbody>`;
      table.querySelectorAll("input[data-task-index]").forEach(input => {
        input.addEventListener("input", (event) => {
          const idx = Number(event.target.dataset.taskIndex);
          tasks[idx].baseHours = Number(event.target.value) || 0;
          recalc();
        });
      });
    }

    function applyRatePreset(key) {
      const preset = RATE_PRESETS[key];
      if (!preset) return;
      roles.forEach(role => {
        if (typeof preset.rates[role.id] === "number") {
          role.rate = preset.rates[role.id];
        }
      });
      renderRoles();
      document.getElementById("param_tariff_preset").value = key;
      recalc();
    }

    function applySitePreset(key) {
      const preset = SITE_PRESETS[key];
      if (!preset) return;
      document.getElementById("param_type_site").value = key;
      document.getElementById("param_complexity").value = preset.complexity;
      document.getElementById("param_buffer").value = preset.buffer;
      document.getElementById("param_margin").value = preset.margin;
      document.getElementById("preset_hint").textContent = preset.label;
      document.getElementById("summary_preset").textContent = preset.label;
      recalc();
    }

    function recalc() {
      const complexity = Number(document.getElementById("param_complexity").value) || 1;
      const buffer = Number(document.getElementById("param_buffer").value) || 0;
      const margin = Number(document.getElementById("param_margin").value) || 1;
      const presetKey = document.getElementById("param_type_site").value;
      const preset = SITE_PRESETS[presetKey] || { hoursMultiplier: 1 };
      const hoursMultiplier = preset.hoursMultiplier || 1;

      let totalHours = 0;
      let internal = 0;

      tasks.forEach(task => {
        const hours = task.baseHours * complexity * hoursMultiplier;
        const rate = rolesById[task.role]?.rate || 0;
        totalHours += hours;
        internal += hours * rate;
      });

      const bufferAmount = internal * (buffer / 100);
      const internalWithBuffer = internal + bufferAmount;
      const sell = internalWithBuffer * margin;
      const tjm = totalHours ? sell / (totalHours / 7) : 0;

      document.getElementById("summary_hours").textContent = `${totalHours.toFixed(1)} h`;
      document.getElementById("summary_internal").textContent = `${Math.round(internalWithBuffer).toLocaleString("fr-FR")} €`;
      document.getElementById("summary_buffer_detail").textContent = `Dont buffer : ${Math.round(bufferAmount).toLocaleString("fr-FR")} € (${buffer}% )`;
      document.getElementById("summary_sell").textContent = `${Math.round(sell).toLocaleString("fr-FR")} €`;
      document.getElementById("summary_margin_detail").textContent = `Marge appliquée x${margin.toFixed(2)}`;
      document.getElementById("summary_tjm").textContent = `${Math.round(tjm).toLocaleString("fr-FR")} €`;
    }

    function init() {
      renderRoles();
      renderTasks();
      document.getElementById("param_tariff_preset").addEventListener("change", (e) => applyRatePreset(e.target.value));
      document.getElementById("param_type_site").addEventListener("change", (e) => applySitePreset(e.target.value));
      document.getElementById("param_complexity").addEventListener("change", recalc);
      document.getElementById("param_buffer").addEventListener("input", recalc);
      document.getElementById("param_margin").addEventListener("input", recalc);
      applyRatePreset("agence");
      applySitePreset("campagne");
    }

    init();
  </script>
</body>
</html>
